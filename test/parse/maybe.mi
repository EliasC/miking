lang mcore

let Maybe =
  {
    pub type Maybe :: * -> *
    pub data Nothing : all a. Maybe a
    pub data Just : all a. a -> Maybe a

    let isJust = Lam a. lam m: Maybe a.
      match m with
        case Nothing -> false
      | case Just _ -> true

    let isNothing = Lam a. lam m: Maybe a.
      not (isJust m)

    let map = Lam a. Lam b. lam f: a -> b. lam m: Maybe a.
      match m with
        case Nothing -> Nothing
      | case Just x -> Just (f x)
  }